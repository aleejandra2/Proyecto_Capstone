{% extends "LevelUp/base.html" %}
{% load static %}
{% block title %}Portal del Docente Â· LevelUp{% endblock %}
{% block body_class %}with-docente-navbar{% endblock %}

{% block content %}
<main class="portal-docente min-h-screen">
  <div class="container">

    <!-- HERO HEADER -->
    <div class="portal-hero">
      <div class="portal-hero-content">
        <h1>Â¡Bienvenido, Profesor! ğŸ‘‹</h1>
        <p>Gestiona tus clases, crea actividades y motiva a tus estudiantes a alcanzar nuevos niveles.</p>
        <div class="portal-hero-actions">
          <a href="{% url 'crear' %}" class="btn btn-light">
            <i class="bi bi-plus-circle me-2"></i>Crear actividad
          </a>
          <a href="{% url 'docente_lista' %}" class="btn btn-outline-light">
            <i class="bi bi-folder2-open me-2"></i>Mis actividades
          </a>
        </div>
      </div>
    </div>

    <!-- KPI CARDS -->
    <div class="kpi-grid">
      <div class="kpi-card kpi-students">
        <div class="kpi-icon">ğŸ‘¥</div>
        <div class="kpi-label">Estudiantes activos</div>
        <div class="kpi-value">
          {{ total_estudiantes|default:0 }}
        </div>
      </div>

      <div class="kpi-card kpi-activities">
        <div class="kpi-icon">ğŸ“š</div>
        <div class="kpi-label">Actividades creadas</div>
        <div class="kpi-value">{{ total_actividades|default:0 }}</div>
      </div>

      <div class="kpi-card kpi-average">
        <div class="kpi-icon">â­</div>
        <div class="kpi-label">Ãšltimo inicio de sesiÃ³n</div>
        <div class="kpi-value">
          {% if request.user.last_login %}
          {{ request.user.last_login|date:"d/m/Y H:i" }}
          {% else %}
          â€”
          {% endif %}
        </div>
      </div>

      <div class="kpi-card kpi-days">
        <div class="kpi-icon">ğŸ“…</div>
        <div class="kpi-label">Miembro desde</div>
        <div class="kpi-value">
          {{ request.user.date_joined|date:"d/m/Y" }}
        </div>
      </div>
    </div>

    <!-- ACTIVIDAD RECIENTE -->
    <div class="activity-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="emoji">ğŸ‘€</span>
          Actividad reciente
        </h2>
        <!-- <a href="{% url 'docente_lista' %}" class="section-link">
          Ver todo <i class="bi bi-arrow-right"></i>
        </a> -->
      </div>

      {% if actividad_reciente %}
      <div class="activity-timeline">
        {% for evento in actividad_reciente %}
        <div class="activity-item">
          <div class="activity-avatar purple">
            {{ evento.iniciales }}
          </div>
          <div class="activity-content">
            <div class="activity-text">
              <strong>{{ evento.estudiante_nombre }}</strong>
              {{ evento.descripcion }}
              {% if evento.actividad_titulo %}
              <span class="highlight">"{{ evento.actividad_titulo }}"</span>
              {% endif %}
            </div>
            <div class="activity-meta">
              <i class="bi bi-clock"></i> {{ evento.hace }}
            </div>
          </div>

          {% if evento.badge_tipo == "puntos" %}
          <span class="activity-badge points">
            <i class="bi bi-star-fill"></i> +{{ evento.puntos }} pts
          </span>
          {% elif evento.badge_tipo == "nivel" %}
          <span class="activity-badge level-up">
            <i class="bi bi-trophy-fill"></i> {{ evento.badge_texto }}
          </span>
          {% elif evento.badge_tipo == "completado" %}
          <span class="activity-badge completed">
            <i class="bi bi-check-circle-fill"></i> {{ evento.badge_texto }}
          </span>
          {% endif %}
        </div>
        {% endfor %}
      </div>
      {% else %}
      <div class="empty-state">
        <div class="empty-state-icon">ğŸ“­</div>
        <div class="empty-state-text">
          AÃºn no hay actividad reciente de tus estudiantes.
        </div>
      </div>
      {% endif %}
    </div>

    <!-- ACCIONES RÃPIDAS -->
    <div class="activity-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="emoji">âš¡</span>
          Acciones rÃ¡pidas
        </h2>
      </div>

      <div class="quick-actions-grid">
        <a href="{% url 'crear' %}" class="action-card primary">
          <div class="action-icon">ğŸ“</div>
          <div class="action-title">Crear actividad</div>
          <div class="action-description">
            DiseÃ±a nuevas actividades y desafÃ­os para tus estudiantes
          </div>
        </a>

        <a href="{% url 'docente_lista' %}" class="action-card secondary">
          <div class="action-icon">ğŸ“š</div>
          <div class="action-title">Mis actividades</div>
          <div class="action-description">
            Revisa y administra todas tus actividades creadas
          </div>
        </a>
      </div>
    </div>

  </div>
</main>
<link rel="stylesheet" href="{% static 'LevelUp/css/portal_docente.css' %}">
{% endblock %}